#!/usr/bin/python3
# --------------------------------------------------------------------------
# Class definition of Pump
#
# Author: Benjamin Fuchs
# License: GPL3
#
# Website: https://github.com/benjaminfuchs/who_disposer
#
# --------------------------------------------------------------------------

from Adafruit_MotorHAT import Adafruit_MotorHAT, Adafruit_DCMotor

import time


class Pump():
    """ Led class """


    def __init__(self, address):
        """ Constructor """
        self._mh = Adafruit_MotorHAT(addr=address)
        self._motor = self._mh.getMotor(3)


    def __del__(self):
        self._turnOffMotors()


    def _turnOffMotors(self):
        """ recommended for auto-disabling motors on shutdown """
        self._mh.getMotor(1).run(Adafruit_MotorHAT.RELEASE)
        self._mh.getMotor(2).run(Adafruit_MotorHAT.RELEASE)
        self._mh.getMotor(3).run(Adafruit_MotorHAT.RELEASE)
        self._mh.getMotor(4).run(Adafruit_MotorHAT.RELEASE)


    def pump(self, milliliter):
        """ pump amount of milliliters """
        self._motor.run(Adafruit_MotorHAT.FORWARD)

        for i in range(70):
            self._motor.setSpeed(i)
            time.sleep(0.01)

        time.sleep(milliliter)

        for i in reversed(range(70)):
            self._motor.setSpeed(i)
            time.sleep(0.01)
